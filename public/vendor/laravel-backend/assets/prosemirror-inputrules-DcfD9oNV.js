import{a as g}from"./prosemirror-state-ZXWGzTNx.js";class o{constructor(n,e,t={}){this.match=n,this.match=n,this.handler=typeof e=="string"?C(e):e,this.undoable=t.undoable!==!1,this.inCode=t.inCode||!1}}function C(l){return function(n,e,t,s){let i=l;if(e[1]){let u=e[0].lastIndexOf(e[1]);i+=e[0].slice(u+e[1].length),t+=u;let r=t-s;r>0&&(i=e[0].slice(u-r,u)+i,t=s)}return n.tr.insertText(i,t,s)}}const $=500;function M({rules:l}){let n=new g({state:{init(){return null},apply(e,t){let s=e.getMeta(this);return s||(e.selectionSet||e.docChanged?null:t)}},props:{handleTextInput(e,t,s,i){return d(e,t,s,i,l,n)},handleDOMEvents:{compositionend:e=>{setTimeout(()=>{let{$cursor:t}=e.state.selection;t&&d(e,t.pos,t.pos,"",l,n)})}}},isInputRules:!0});return n}function d(l,n,e,t,s,i){if(l.composing)return!1;let u=l.state,r=u.doc.resolve(n),h=r.parent.textBetween(Math.max(0,r.parentOffset-$),r.parentOffset,null,"￼")+t;for(let c=0;c<s.length;c++){let f=s[c];if(r.parent.type.spec.code){if(!f.inCode)continue}else if(f.inCode==="only")continue;let p=f.match.exec(h),a=p&&f.handler(u,p,n-(p[0].length-t.length),e);if(a)return f.undoable&&a.setMeta(i,{transform:a,from:n,to:e,text:t}),l.dispatch(a),!0}return!1}new o(/--$/,"—");new o(/\.\.\.$/,"…");new o(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"“");new o(/"$/,"”");new o(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"‘");new o(/'$/,"’");export{o as I,M as i};
